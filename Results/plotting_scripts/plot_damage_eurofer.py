import matplotlib.pyplot as plt
import numpy as np
from scipy.stats import linregress

data_dpa = [
    # x (m)              , damage (dpa/fpy)
    (0.014130520194876595, 10.179364919581293),
    (0.0305916292125627, 9.572897342766186),
    (0.044194795927469166, 9.33038389754577),
    (0.05703158705280342, 8.249620008176956),
    (0.07224733573743469, 7.656840184107432),
    (0.08804032244626298, 6.677003476542013),
    (0.1018645590427768, 5.936725870697137),
    (0.11661728914204156, 5.805200289688424),
    (0.1313700192413063, 5.344888094214455),
    (0.14672627011735917, 4.557911714553536),
    (0.15962373264353458, 4.519462975116917),
    (0.17562820953910058, 4.236352320127739),
    (0.1916382745900072, 3.6915358300403023),
    (0.2042866230333661, 3.5100480831321255),
    (0.21988639983689484, 3.301780402033812),
    (0.2346391299361596, 3.0103210256185022),
    (0.2497111831977461, 2.518552231542231),
    (0.2629950267503309, 2.5120951816521235),
    (0.2788973202339538, 2.3429380969693825),
    (0.29483342440535215, 1.9934866830869404),
    (0.30735965810223237, 1.9082649055170733),
    (0.3231555105317481, 1.8006769735379529),
    (0.33846705616507594, 1.5869152305264984),
    (0.3508962900963943, 1.3828999119638503),
    (0.36380289276328875, 1.3827274519341246),
    (0.37844099403505344, 1.152028405684317),
    (0.39527996879482025, 1.0922949536251862),
    (0.40780620249170046, 1.061080754460811),
    (0.4237423066630987, 0.9889264554671494),
    (0.43964460014672174, 0.8499650269162957),
    (0.45292844369930635, 0.7755043132198083),
    (0.4691500603452515, 0.7799454661903372),
    (0.4814958921085158, 0.7658245964207098),
    (0.49080017075066557, 0.6219237233867554),
    (0.503608222791391, 0.5880752813000264),
    (0.5189644736674439, 0.5608913583375047),
    (0.5337172037667086, 0.5106640246647154),
    (0.5484699338659733, 0.4206411834031937),
    (0.5622941704624871, 0.4248530489923733),
    (0.5779753940645029, 0.3952308342536156),
    (0.5939114982359011, 0.3412765143142756),
    (0.6062974801908989, 0.3276420389852329),
    (0.6222335843622973, 0.30206010497001656),
    (0.6379148079643129, 0.2619991381742926),
    (0.6517390445608269, 0.23394457583164144),
    (0.6664917746600914, 0.2241638478330096),
    (0.6812445047593563, 0.2038045970884875),
    (0.696600755635409, 0.16936814922712878),
    (0.7094982181615845, 0.16665104889520194),
    (0.7255026950571504, 0.1523094108692447),
    (0.7327114154465639, 0.1274067665996568),
    (0.7472805347274936, 0.12313474917409034),
    (0.7605643782800784, 0.11887511880386498),
    (0.7764666717637014, 0.10509380897075267),
    (0.7924027759350998, 0.08625764740424968),
    (0.8049290096319799, 0.08102209877645952),
]

green_ryb = (117 / 255, 184 / 255, 42 / 255)

plt.rc("text", usetex=True)
plt.rc("font", family="serif", size=12)

x = np.linspace(0.00, 0.80)

data_dpa = np.array(data_dpa)
year = 365.25 * 24 * 3600
plt.scatter(data_dpa[:, 0], data_dpa[:, 1], color=green_ryb)

# res = linregress(data_dpa[:, 0], np.log(data_dpa[:, 1]))
# damage = np.exp(res.intercept) * np.exp(x * res.slope)
# plt.plot(x, damage, color="black",
#          label="Damage : {:.2e} exp ({:.3}*x)".format(np.exp(res.intercept),
#                                                       res.slope))
# print(res.rvalue**2)
plt.rc("text", usetex=True)
plt.rc("font", family="serif", size=12)

plt.yscale("log")
plt.xlabel(r"Distance from the FW (m)")
plt.xlim(0, 0.8)
# plt.ylim(1e-09, 1e-6)
plt.ylabel(r"Damage (dpa/fpy)")
ax = plt.gca()
ax.spines["top"].set_visible(False)
ax.spines["right"].set_visible(False)
# plt.legend()
plt.show()
